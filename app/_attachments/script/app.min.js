var _pl={db:"peoples-lib",design:"peoples-lib"},PeoplesLibApp=angular.module("PeoplesLibApp",["CornerCouch"]);PeoplesLibApp.controller("ListingCtrl",["$scope","$http","cornercouch",function(e,n,o){function c(e){var n=e.doc;return n._attachments&&angular.forEach(n._attachments,function(e,o){/^cover\./.test(o)?n.coverImg="/"+t.db+"/"+n._id+"/"+o:(n.media=e,n.media.url="/"+t.db+"/"+n._id+"/"+o)}),n}var t=window._pl;e.db=o().getDB(t.db),e.upload=function(n){for(var o,c=[],t=0;o=n.files[t];t++)c.push(o);c.forEach(function(n){var o=e.db.newDoc({name:n.name,content_type:n.type});o.save().success(function(){o.attach(n,n.name)})})},e.db.query(t.design,"media",{reduce:!1,limit:10,include_docs:!0}).success(function(n){e.medias=n.rows.map(c)})}]);